import{O,h as r,ag as y,H as t,ap as $,ak as F,T as _,aj as B,an as H,ao as R}from"./index-xPavhQe8.js";const U=()=>{const l=O(),[c,d]=r.useState([]),[j,g]=r.useState(!0),[u,n]=r.useState(null),[C,x]=r.useState(!1),[o,m]=r.useState(null),[N,p]=r.useState(!1),[i,z]=r.useState("");r.useEffect(()=>{h()},[]);const h=async()=>{try{g(!0),n(null);const e=await y.getCategories(),a=e.data?e.data.map(s=>({id:s.id,title:s.title,parent:s.parent_category?.title||"No Parent",status:s.status==="active"?"Active":"Inactive",createdDate:b(s.createdAt||s.created_at),image:s.image||s.image_url})):[];d(a)}catch(e){console.error("Error fetching categories:",e),n("Failed to load categories. Please try again.")}finally{g(!1)}},b=e=>{if(!e)return"N/A";try{const a=new Date(e);if(isNaN(a.getTime()))return"N/A";const s=a.getDate().toString().padStart(2,"0"),A=a.toLocaleDateString("en-US",{month:"short"}).toUpperCase(),E=a.getFullYear(),k=a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return`${s} / ${A} / ${E} ${k}`}catch(a){return console.error("Error formatting date:",a),"N/A"}},v=()=>{l("/menu/category/add_category")},w=e=>{l(`/menu/category/edit_category/${e}`)},D=e=>{m(e),x(!0)},f=()=>{x(!1),m(null)},S=async()=>{if(o)try{p(!0),await y.deleteCategory(o.id),d(c.filter(e=>e.id!==o.id)),console.log("Category deleted successfully")}catch(e){console.error("Error deleting category:",e),n("Failed to delete category. Please try again.")}finally{p(!1),f()}},L=c.filter(e=>e.title.toLowerCase().includes(i.toLowerCase())||e.parent.toLowerCase().includes(i.toLowerCase())||e.status.toLowerCase().includes(i.toLowerCase())),T=[{name:"Title",selector:e=>e.title,sortable:!0,cell:e=>t.jsxs("div",{className:"flex items-center py-2",children:[t.jsx("img",{src:e.image,alt:e.title,className:"w-12 h-12 mr-3 object-cover rounded",onError:a=>{}}),t.jsx("span",{children:e.title})]})},{name:"Parent",selector:e=>e.parent,sortable:!0},{name:"Status",selector:e=>e.status,sortable:!0,cell:e=>t.jsx("span",{className:`px-4 py-1 rounded-full text-sm ${e.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.status})},{name:"Created Date",selector:e=>e.createdDate,sortable:!0,width:"300px"},{name:"Action",cell:e=>t.jsxs("div",{className:"flex justify-center space-x-2",children:[t.jsx("button",{className:"p-1 text-gray-500 hover:text-indigo-600",onClick:()=>w(e.id),children:t.jsx(H,{size:20})}),t.jsx("button",{className:"p-1 text-gray-500 hover:text-red-600",onClick:()=>D(e),children:t.jsx(R,{size:20})})]}),button:!0,width:"120px"}],P={headCells:{style:{backgroundColor:"#312e81",color:"white",paddingLeft:"16px",paddingRight:"16px",paddingTop:"12px",paddingBottom:"12px",fontWeight:"500"}},rows:{style:{minHeight:"72px","&:not(:last-of-type)":{borderBottomStyle:"solid",borderBottomWidth:"1px",borderBottomColor:"#e5e7eb"}}},pagination:{style:{backgroundColor:"#ffffff",borderTop:"1px solid #e5e7eb",borderRadius:"0 0 8px 8px"}}};return j?t.jsx("div",{className:"px-6 py-7 bg-white rounded-lg shadow-xl",children:t.jsxs("div",{className:"flex items-center justify-center py-8",children:[t.jsx($,{className:"w-8 h-8 animate-spin text-indigo-600"}),t.jsx("span",{className:"ml-2 text-gray-600",children:"Loading categories..."})]})}):u?t.jsx("div",{className:"px-6 py-7 bg-white rounded-lg shadow-xl",children:t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-red-600 mb-4",children:u}),t.jsx("button",{onClick:h,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"Try Again"})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-6 py-7 bg-white rounded-lg shadow-xl",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-2xl font-medium text-gray-800",children:"Category"}),t.jsxs("button",{className:"px-4 py-2 bg-indigo-900 text-white rounded-md flex items-center hover:bg-indigo-800",onClick:v,children:[t.jsx("span",{className:"mr-2",children:"+"}),"Add New Category"]})]}),t.jsx(F,{isOpen:C,onClose:f,onConfirm:S,itemName:o?o.title:"",isLoading:N})]}),t.jsx("div",{className:"",children:t.jsx(_,{columns:T,data:L,pagination:!0,paginationPerPage:8,paginationRowsPerPageOptions:[8,15,30,50],customStyles:P,highlightOnHover:!0,pointerOnHover:!0,sortIcon:t.jsx(B,{size:16}),noDataComponent:t.jsx("div",{className:"py-8 text-center text-gray-500",children:"No categories found"})})})]})};export{U as default};
